import { useSorobanReact } from '@soroban-react/core';
import { isConnected } from '@stellar/freighter-api';
import Link from 'next/link';
import React, { Fragment, useEffect, useState } from 'react';
import { Button, Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from 'ui';

const FreighterIcon = () => (
  <svg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'>
    <g clipPath='url(#clip0_471_814)'>
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M7.0625 3.3125C7.66016 3.37568 8.16016 3.52152 8.5625 3.75C8.35416 3.79167 8.14584 3.83334 7.9375 3.875C8.27084 3.91667 8.60416 3.95834 8.9375 4C8.797 4.03115 8.672 4.09365 8.5625 4.1875C8.625 4.22917 8.6875 4.27084 8.75 4.3125C8.97365 4.19887 9.20283 4.17803 9.4375 4.25C9.35416 4.29167 9.27084 4.33334 9.1875 4.375C9.52374 4.41682 9.60706 4.56265 9.4375 4.8125C8.60416 4.8125 7.77084 4.8125 6.9375 4.8125C6.9481 5.20612 6.8231 5.53944 6.5625 5.8125C6.59666 5.56863 6.51333 5.38113 6.3125 5.25C6.45283 5.11954 6.61949 5.0362 6.8125 5C6.3365 4.774 5.98234 4.41984 5.75 3.9375C5.75 4.1875 5.75 4.4375 5.75 4.6875C5.66615 4.78155 5.56199 4.82323 5.4375 4.8125C5.84591 3.65029 5.47091 2.87947 4.3125 2.5C3.94911 2.41019 3.61577 2.47269 3.3125 2.6875C3.28706 2.4512 3.3704 2.2637 3.5625 2.125C3.21706 2.05847 2.88372 1.95429 2.5625 1.8125C2.30625 1.84297 2.05625 1.88463 1.8125 1.9375C3.29893 0.622069 4.79892 0.622069 6.3125 1.9375C6.67419 2.33935 6.92419 2.79768 7.0625 3.3125Z'
        fill='#A37DF9'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M3.3125 2.6875C2.44939 3.23709 2.24105 3.98709 2.6875 4.9375C2.61032 4.95134 2.54782 4.993 2.5 5.0625C2.25304 4.6613 2.1697 4.24463 2.25 3.8125C2.20834 3.89584 2.16666 3.97916 2.125 4.0625C1.74795 3.72525 1.72712 3.37108 2.0625 3C1.90719 2.96107 1.78219 3.02357 1.6875 3.1875C1.51969 3.01221 1.41552 3.05389 1.375 3.3125C1.29115 3.21845 1.18699 3.17677 1.0625 3.1875C1.25003 2.72837 1.50003 2.31171 1.8125 1.9375C2.05625 1.88463 2.30625 1.84296 2.5625 1.8125C2.88372 1.95429 3.21706 2.05846 3.5625 2.125C3.3704 2.2637 3.28706 2.4512 3.3125 2.6875Z'
        fill='#976FF7'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M5.43753 4.81248C5.04 5.46905 4.45667 5.71905 3.68753 5.56248C3.28989 5.45642 2.95657 5.24809 2.68753 4.93748C2.24108 3.98707 2.44942 3.23707 3.31253 2.68749C3.6158 2.47267 3.94914 2.41017 4.31253 2.49999C5.47094 2.87945 5.84594 3.65027 5.43753 4.81248Z'
        fill='#0C193A'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M10.9375 3.3125C12.2708 3.3125 13.6041 3.3125 14.9375 3.3125C14.9375 3.8125 14.9375 4.3125 14.9375 4.8125C14.6041 4.8125 14.2709 4.8125 13.9375 4.8125C13.9375 5.6875 13.9375 6.5625 13.9375 7.4375C13.3959 7.4375 12.8541 7.4375 12.3125 7.4375C12.3125 6.5625 12.3125 5.6875 12.3125 4.8125C12.4363 5.62238 12.478 6.45571 12.4375 7.3125C12.8959 7.3125 13.3541 7.3125 13.8125 7.3125C13.8591 6.46351 13.7757 5.63019 13.5625 4.8125C13.2974 4.62244 13.1099 4.37244 13 4.0625C12.5435 4.47864 12.0643 4.47864 11.5625 4.0625C11.6042 4.02084 11.6458 3.97916 11.6875 3.9375C11.9387 4.14641 12.2304 4.22975 12.5625 4.1875C12.5625 4.0625 12.5625 3.9375 12.5625 3.8125C12.2851 3.56603 11.7435 3.39936 10.9375 3.3125Z'
        fill='#BE9DFC'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M7.0625 3.3125C7.6875 3.3125 8.3125 3.3125 8.9375 3.3125C9.77375 3.41849 10.6071 3.60599 11.4375 3.875C10.8992 3.98326 10.8575 4.10826 11.3125 4.25C10.8526 4.50503 10.8526 4.69253 11.3125 4.8125C11.3125 5.6875 11.3125 6.5625 11.3125 7.4375C10.8125 7.4375 10.3125 7.4375 9.8125 7.4375C9.8125 6.5625 9.8125 5.6875 9.8125 4.8125C9.6875 4.8125 9.5625 4.8125 9.4375 4.8125C9.60706 4.56265 9.52374 4.41681 9.1875 4.375C9.27084 4.33334 9.35416 4.29166 9.4375 4.25C9.20283 4.17803 8.97365 4.19886 8.75 4.3125C8.6875 4.27084 8.625 4.22916 8.5625 4.1875C8.672 4.09365 8.797 4.03115 8.9375 4C8.60416 3.95834 8.27084 3.91666 7.9375 3.875C8.14584 3.83334 8.35416 3.79166 8.5625 3.75C8.16016 3.52151 7.66016 3.37568 7.0625 3.3125Z'
        fill='#AB86FA'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M8.9375 3.3125C9.60416 3.3125 10.2708 3.3125 10.9375 3.3125C11.7435 3.39936 12.2851 3.56603 12.5625 3.8125C12.5625 3.9375 12.5625 4.0625 12.5625 4.1875C12.2304 4.22975 11.9387 4.14641 11.6875 3.9375C11.6458 3.97916 11.6042 4.02084 11.5625 4.0625C12.0643 4.47864 12.5435 4.47864 13 4.0625C13.1099 4.37244 13.2974 4.62244 13.5625 4.8125C13.7758 5.63019 13.8591 6.46351 13.8125 7.3125C13.3541 7.3125 12.8959 7.3125 12.4375 7.3125C12.478 6.45571 12.4363 5.62238 12.3125 4.8125C11.9792 4.8125 11.6458 4.8125 11.3125 4.8125C10.8526 4.69253 10.8526 4.50503 11.3125 4.25C10.8575 4.10826 10.8992 3.98326 11.4375 3.875C10.6071 3.60599 9.77375 3.41849 8.9375 3.3125Z'
        fill='#B490FB'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M6.5625 5.8125C6.21619 6.32557 5.75785 6.70057 5.1875 6.9375C5.05024 6.82538 5.05024 6.72121 5.1875 6.625C4.93718 6.39766 4.7705 6.12683 4.6875 5.8125C4.28774 5.87945 3.95441 5.79612 3.6875 5.5625C4.45664 5.71906 5.03997 5.46906 5.4375 4.8125C5.56199 4.82323 5.66615 4.78155 5.75 4.6875C5.75 4.4375 5.75 4.1875 5.75 3.9375C5.98234 4.41984 6.3365 4.774 6.8125 5C6.61949 5.0362 6.45283 5.11954 6.3125 5.25C6.51332 5.38112 6.59666 5.56862 6.5625 5.8125Z'
        fill='#9971F7'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M2.6875 4.9375C2.95654 5.2481 3.28986 5.45644 3.6875 5.5625C3.95441 5.79613 4.28774 5.87945 4.6875 5.8125C4.7705 6.12683 4.93718 6.39767 5.1875 6.625C5.05024 6.72122 5.05024 6.82538 5.1875 6.9375C2.66064 7.4564 1.24397 6.41474 0.9375 3.8125C0.948955 3.59278 0.990621 3.38444 1.0625 3.1875C1.18699 3.17678 1.29115 3.21845 1.375 3.3125C1.41552 3.05389 1.51969 3.01222 1.6875 3.1875C1.78219 3.02358 1.90719 2.96108 2.0625 3C1.72712 3.37108 1.74795 3.72525 2.125 4.0625C2.16666 3.97917 2.20834 3.89584 2.25 3.8125C2.1697 4.24463 2.25304 4.6613 2.5 5.0625C2.54782 4.993 2.61032 4.95134 2.6875 4.9375Z'
        fill='#8F65F6'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M3.5625 11.0625C3.43866 10.2526 3.397 9.41929 3.4375 8.5625C2.97916 8.5625 2.52084 8.5625 2.0625 8.5625C2.103 9.41929 2.06134 10.2526 1.9375 11.0625C1.9375 10.1875 1.9375 9.3125 1.9375 8.4375C2.47916 8.4375 3.02084 8.4375 3.5625 8.4375C3.5625 9.3125 3.5625 10.1875 3.5625 11.0625Z'
        fill='#A88FF7'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M14.3125 13.5625C14.2386 13.4811 14.1554 13.3978 14.0625 13.3125C14.1875 13.2084 14.3125 13.1041 14.4375 13C14.157 12.703 14.1154 12.3696 14.3125 12C14.194 11.9397 14.069 11.9188 13.9375 11.9375C13.9673 12.3874 13.8423 12.4291 13.5625 12.0625C13.4929 12.2915 13.3679 12.4581 13.1875 12.5625C13.4991 10.7286 12.7491 10.0411 10.9375 10.5C10.4006 10.8866 10.1923 11.4075 10.3125 12.0625C10.0418 11.7085 10.0418 11.3543 10.3125 11C9.95431 10.6996 9.97515 10.5955 10.375 10.6875C10.4092 10.4589 10.5134 10.2714 10.6875 10.125C10.5005 10.0616 10.3547 10.1241 10.25 10.3125C10.1919 10.1337 10.0877 9.98781 9.9375 9.875C10.0808 9.79439 10.2058 9.69021 10.3125 9.5625C10.4542 9.82323 10.6834 10.0732 11 10.3125C11.1774 10.1925 11.3649 10.0883 11.5625 10C11.2544 9.54334 10.8378 9.2725 10.3125 9.1875C11.6716 8.46728 12.9424 8.63394 14.125 9.6875C15.1329 10.9506 15.1954 12.2422 14.3125 13.5625Z'
        fill='#A37EF8'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M3.5625 11.0625C3.89584 11.0625 4.22916 11.0625 4.5625 11.0625C4.66494 10.7118 4.72744 10.3368 4.75 9.9375C4.79166 10.2708 4.83334 10.6042 4.875 10.9375C4.90615 10.797 4.96865 10.672 5.0625 10.5625C5.29036 10.7697 5.49869 10.9989 5.6875 11.25C5.9375 11.25 6.1875 11.25 6.4375 11.25C5.95312 11.4183 5.95312 11.5642 6.4375 11.6875C6.37184 11.774 6.28851 11.8365 6.1875 11.875C7.1459 11.9766 7.10424 12.0599 6.0625 12.125C6.42474 12.1795 6.7164 12.3253 6.9375 12.5625C4.9375 12.5625 2.9375 12.5625 0.9375 12.5625C0.9375 12.0625 0.9375 11.5625 0.9375 11.0625C1.27084 11.0625 1.60416 11.0625 1.9375 11.0625C2.06134 10.2526 2.103 9.41929 2.0625 8.5625C2.52084 8.5625 2.97916 8.5625 3.4375 8.5625C3.397 9.41929 3.43866 10.2526 3.5625 11.0625Z'
        fill='#7A4DF4'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M13.1875 12.5625C12.3522 13.6698 11.4564 13.7114 10.5 12.6875C10.3739 12.4969 10.3114 12.2886 10.3125 12.0625C10.1923 11.4075 10.4007 10.8866 10.9375 10.5C12.7491 10.0411 13.4991 10.7286 13.1875 12.5625Z'
        fill='#0C193A'
      />
      <path
        fillRule='evenodd'
        clipRule='evenodd'
        d='M10.3125 9.1875C10.8378 9.2725 11.2544 9.54334 11.5625 10C11.3649 10.0883 11.1774 10.1925 11 10.3125C10.6834 10.0732 10.4542 9.82323 10.3125 9.5625C10.2057 9.69021 10.0807 9.79439 9.9375 9.875C10.0877 9.98781 10.1919 10.1337 10.25 10.3125C10.3547 10.1241 10.5005 10.0616 10.6875 10.125C10.5134 10.2714 10.4092 10.4589 10.375 10.6875C9.97515 10.5954 9.95431 10.6996 10.3125 11C10.0418 11.3543 10.0418 11.7085 10.3125 12.0625C10.3114 12.2885 10.3739 12.4969 10.5 12.6875C11.4564 13.7114 12.3522 13.6698 13.1875 12.5625C13.3679 12.4581 13.4929 12.2915 13.5625 12.0625C13.8422 12.4291 13.9672 12.3874 13.9375 11.9375C14.069 11.9188 14.194 11.9397 14.3125 12C14.1154 12.3696 14.157 12.703 14.4375 13C14.3125 13.1041 14.1875 13.2084 14.0625 13.3125C14.1554 13.3977 14.2386 13.4811 14.3125 13.5625C13.8682 14.316 13.2016 14.7535 12.3125 14.875C10.5806 15.0087 9.41389 14.2587 8.8125 12.625C8.18889 12.5626 7.56389 12.5417 6.9375 12.5625C6.7164 12.3253 6.42474 12.1795 6.0625 12.125C7.10424 12.0599 7.1459 11.9766 6.1875 11.875C6.28851 11.8365 6.37184 11.774 6.4375 11.6875C5.95312 11.5642 5.95312 11.4183 6.4375 11.25C6.1875 11.25 5.9375 11.25 5.6875 11.25C5.49869 10.9989 5.29036 10.7697 5.0625 10.5625C4.96865 10.672 4.90615 10.797 4.875 10.9375C4.83334 10.6042 4.79166 10.2708 4.75 9.9375C4.72744 10.3368 4.66494 10.7118 4.5625 11.0625C4.5625 10.1875 4.5625 9.3125 4.5625 8.4375C5.0625 8.4375 5.5625 8.4375 6.0625 8.4375C6.0625 9.3125 6.0625 10.1875 6.0625 11.0625C6.98011 11.0833 7.89678 11.0625 8.8125 11C9.06687 10.1839 9.56687 9.57976 10.3125 9.1875Z'
        fill='#8E64F6'
      />
    </g>
    <defs>
      <clipPath id='clip0_471_814'>
        <rect width='16' height='16' fill='white' />
      </clipPath>
    </defs>
  </svg>
);

export const ConnectorsModal = () => {
  const { connectors, connect } = useSorobanReact();
  const [isFreighter, setFreighter] = useState(false);

  useEffect(() => {
    void (async () => setFreighter(await isConnected()))();
  }, []);

  return (
    <Dialog>
      <DialogTrigger asChild>
        <Button className='w-[152px] md:w-[192px]'>Connect</Button>
      </DialogTrigger>
      <DialogContent className='flex w-[296px] flex-col'>
        <DialogHeader>
          <DialogTitle>Connect a wallet</DialogTitle>
        </DialogHeader>
        <div className='flex flex-col gap-2'>
          {connectors.map(connector => {
            return (
              <Fragment key={connector.id}>
                <Button
                  variant='outline'
                  className='flex w-full items-center justify-start gap-2 bg-transparent px-[18px] md:w-full'
                  onClick={() => {
                    void (async () => await connect())();
                  }}
                >
                  <FreighterIcon />
                  <p className='text-white'>{connector.name}</p>
                </Button>
                {!isFreighter && (
                  <div className='flex items-center justify-between'>
                    <p className='subtitle3'>Don’t have a Freighter?</p>
                    <Button className='h-[26px] w-[68px] md:h-[26px] md:w-[68px]'>
                      <Link
                        href={connector.downloadUrls?.browserExtension ?? ''}
                        target='_blank'
                        rel='noreferrer noopener'
                      >
                        GET
                      </Link>
                    </Button>
                  </div>
                )}
              </Fragment>
            );
          })}
        </div>
      </DialogContent>
    </Dialog>
  );
};
